<!DOCTYPE HTML>
<html>
  <head>
    <title>Stick-Slip JQuery Plugin Demo and Manual</title>
    <style type="text/css">
      body {
        background-color: #ddd;
        font-size: 100%;
        font-family: Georgia, "Times New Roman", Times, serif;
        margin: 0;
        padding: 0;
      }

      div {
        position: relative;
        border: 0 solid;
        overflow: hidden; 
      }

      p {
        line-height: 1.5em;
        margin: 0 0 1.5em 0;
      }

      pre {
          overflow: auto;  /* This does not work in IE6-... */
          text-align: left;
          font-family: inherit; /* Otherwise it will default to the default monospace font size in FF */
          display: block;
          background-color: #fff;
          border: 1px solid #ccc;
          border-radius: 5px;
          padding: 0.5em;
          margin: 0 0 1.5em 0;
      }

      code {
          font-family: 'Consolas', 'Lucida Console', 'Courier New', monospace;  
          font-size: 0.875em;
          font-weight: bolder;
          color: #666;
      }

      pre code {
          font-weight: normal;
          color: #444;
      }


      #page-width {
        position: relative;
        background-color: #fff;
        border-color: #ccc;
        border-width: 0 2px;
        width: 956px;
        margin: 0 auto;
      }
       
      .id {
        display: block;
        position: absolute;
        top: 50%;
        margin-top: -0.5em;
        width: 100%;
        text-align: center;
        font: bold 200% sans-serif;
        text-shadow: 1px 1px 1px #fff;
        line-height: 1em;
      }     

      .class {
        display: block;
        position: absolute;
        bottom: -0.5em;
        right: 5%;
        text-align: center;
        font: bold 75% sans-serif;
        line-height: 1em;
      }     

      #header, #footer, #content, #sidebar {
        background-color: #fff;
        border-color: #eee;
      }

      #header {
        height: 8em;
        border-width: 0 0 2px 0;
      }

      #footer {
        clear: both;
        height: 6em;
        border-width: 2px 0 0 0;
      }

      #page {
        border-width: 0;
        background-color: #fff;
/*        overflow: hidden;*/
      }

      #content {
        float: left;
        width: 717px;
        border-width: 0 1px 0 0;
      }

      #sidebar {
        float: right;
        width: 237px;
        border-width: 0 0 0 1px;
      }

      #title {
        position: absolute;
        top: 50%;
        margin-top: -1em;
        width: 100%;
        text-align: center;
        color: #000;
        font: bold 200% sans-serif;
        text-shadow: 1px 1px 1px rgba(0,0,0,0.25);
        line-height: 1em;
      }     

      #copyright {
        position: absolute;
        top: 50%;
        margin-top: -0.5em;
        width: 100%;
        text-align: center;
        line-height: 1em;
      }     

      h1 {
        font-family: sans-serif;
        font-size: 150%;
      }

      h2 {
        font-family: sans-serif;
        font-size: 125%;
      }

      #toc {
        background-color: #f8f;
        border: 2px solid #848;
        margin: 10px;
        padding: 10px;
        box-shadow: 7px 7px 5px rgba(136,68,136,0.5);
      }

      #toc p {
        color: #880;
        font-family: sans-serif;
        text-align: left;
        margin-bottom: 1em;
      }

      #toc p:last-child {
        margin-bottom: 0;
      }

      .spaceafter {
        margin-bottom: 1.5em;
      }

      .nospaceafter {
        margin-bottom: 0;
      }

      .block-body {
        color: #000;
        background-color: #eff;
        margin: 0em 1em 2em 150px;
        padding: 1em 10px;
        border: 1px dotted #899;
        text-align: left;
        overflow: visible; /* WebKit margin bug when float meets overflow:hidden */
      }

      .block-header {
        clear: both;
        text-align: left;
        margin: 1em 10px 0.5em 160px;
        color: #000;
      }

      .block-meta {
        clear: left;
        float: left;
        border: 1px solid #cc6;
        background-color: #ff8;
        box-shadow: 5px 5px 5px #884;
        color: #000;
        width: 100px;
        height: 5em;
        margin-left: 10px;
        padding: 10px;
        font-size: 75%;
        text-align: center; 
      }

      .block-meta-wrapper {
        clear: left;
        float: left;
        border: 1px dotted #ccb;
        background-color: #ffe;
        color: #000;
        width: 122px; 
        margin-left: 10px;
        padding: 0;
        overflow: visible;
      }

      .obstacle {
        position: absolute;
        width: 180px;
        height: 20px;
        background-color: #c00;
        border: 2px solid #800;
        color: #fff;
      }

      .loremipsum {
        color: #abb;
      }

    </style>
  </head>
  <body>
    <div id="page-width">
      <div id="header">
        <div id="title" class="title">
          Stick-Slip jQuery Plugin by <a href="http://www.dmitryleskov.com">Dmitry Leskov</a><br>
          <small>2-in-1: Demo and Manual</small>
        </div>
      </div>
      <div id="page">
        <div id="content">
          <div class="block">
            <div class="block-header" id="block-header-0">
            <p align="right">
              <i>The stick-slip phenomenon, also known as the slip-stick 
              phenomenon or simply stick-slip, is the spontaneous jerking 
              motion that can occur while two objects are sliding over each other.
              </i>
            </p>
            <p align="right">
              &mdash; From Wikipedia, the free encyclopedia
            </p>
            <h1>Usage</h1>
<pre><code>&lt;script type="text/javascript" src="jquery-<i>version</i>.min.js">&lt;/script&gt;
&lt;script type="text/javascript" src="jquery.stickers.min.js">&lt;/script&gt;
&lt;script type="text/javascript" &gt;
  <i>sticker</i>.stick(<i>base</i>)
&lt;/script&gt;
</code></pre>
             <p>
               where <code><i>sticker</i></code> is a jQuery object specifying 
               the sticker element, and <code><i>base</i></code> is a jQuery 
               object specifying its base element.
             </p>
              <h1>When It Sticks, It Sticks</h1>
              <p>
                A sticker element &ldquo;sticks&rdquo; to the screen when 
                the top edge of its <em>margin box</em> reaches the top of the viewport 
                as the visitor scrolls down the page, remains there until 
                the bottom edge of its <i>border box</i> is aligned with the bottom edge 
                of its <em>base element's</em> border box, and then &ldquo;sticks&rdquo; 
                back to the page.
              </p>
              <p>
                Typically, a sticker would float either alongside its base:
              </p>
              <div class="spaceafter" style="display: block; position: relative">
                <div style="display: block; position: absolute; width: 150px; height: 220px;">
                  <div style="display: block; 
                              position: absolute;
                              top: 0;
                              width: 100%;
                              height: 10px; 
                              background: red;"
                  ></div>
                  <div style="display: block; 
                              position: absolute;
                              left: 5px;
                              top: 10px;
                              width: 0; 
                              height: 0; 
                              border-left: 30px solid transparent;
                              border-right: 30px solid transparent;
                              border-bottom: 60px solid red;"
                  ></div>
                  <div style="display: block; 
                              position: absolute;
                              top: 70px;
                              left: 15px;
                              width: 40px; 
                              height: 80px; 
                              background: red;"
                  ></div>
                  <div style="display: block; 
                              position: absolute;
                              right: 5px;
                              top: 10px;
                              width: 0; 
                              height: 0; 
                              border-left: 30px solid transparent;
                              border-right: 30px solid transparent;
                              border-bottom: 60px solid red;"
                  ></div>
                  <div style="display: block; 
                              position: absolute;
                              left: 5px;
                              bottom: 10px;
                              width: 0; 
                              height: 0; 
                              border-left: 30px solid transparent;
                              border-right: 30px solid transparent;
                              border-top: 60px solid red;"
                  ></div>
                  <div style="display: block; 
                              position: absolute;
                              top: 70px;
                              right: 15px;
                              width: 40px; 
                              height: 80px; 
                              background: red;"
                  ></div>
                  <div style="display: block; 
                              position: absolute;
                              bottom: 10px;
                              right: 5px;
                              width: 0; 
                              height: 0; 
                              border-left: 30px solid transparent;
                              border-right: 30px solid transparent;
                              border-top: 60px solid red;"
                  ></div>
                  <div style="display: block; 
                              position: absolute;
                              bottom: 0;
                              width: 100%;
                              height: 10px; 
                              background: red;"
                  ></div>
                </div>

                <div class="sample-sticker" id="sticker1" style="float:left; display: block; margin-top: -10px; padding-top: 20px;">
                  <div style="display: block; width: 148px; border: 1px dotted black; background: rgba(255,255,255,0.9);">
                     float: left;<br>
                     width: 150px;
                  </div>
                </div>
                <div class="sample-base" id="base1" style="margin: 10px 0 10px 160px; height: 200px; display: block; border: 1px dotted black">
                  margin-left: 160px;
                </div>
              </div>
              <p>
                or across the page content, e.g. main menu bar placed below some graphic.
                (In the latter case, you must ensure that other elements do not change 
                positions when the sticker element is removed from normal flow.)
              </p>
              <div class="spaceafter" style="display: block">
                <div class="sample-sticker" id="sticker2" style="float: left; width: 100%; display: block; padding-right: 2px; margin-bottom: -52px;">
                  <div style="height: 50px; display: block; border: 1px dotted red; background: rgba(255,255,255,0.9); z-index: 1">
                    float: left; width: 100%; height: 50px;
                  </div>
                </div>
                <div class="sample-base" id="base2" style="height: 200px; display: block; position: relative; top: 60px; margin-bottom: 60px; border: 1px dotted black">
                  position: relative; top: 60px; margin-bottom: 60px;
                </div>
              </div>
              <p>
                Assuming for simplicity that the top margin of 
                the base element is zero, here is how you can control 
                the behavior of the sticker by varying its margin:
              </p>
            </div>
          </div>
          <div class="block">
            <div class="block-header" id="block-header-1">
              <h2>Sticker Has No Top Margin</h2>
            </div>
            <div class="block-meta" id="block-meta-1">
              #sticker1
            </div>
            <div class="block-body" id="block-body-1">
<pre><code>#sticker1 {
  margin-top: 0;
}</code></pre>
              <p>
                The sticker starts slipping upon its top <i>border</i> hitting the viewport
                boundary and slips until its bottom border is aligned with the bottom
                border of the base element.
              </p>
            </div>
          </div>
          <div class="block">
            <div class="block-header" id="block-header-2">
              <h2>Sticker Has Positive Top Margin</h2>
            </div>
            <div class="block-meta" id="block-meta-2" style="margin-top: 3.987em">
              #sticker2
            </div>
            <div class="block-body" id="block-body-2">
<pre><code>#sticker2 {
  margin-top: 50px;
}</code></pre>
              <p>
                The sticker keeps distance equal to its top margin from
                the top of the viewport until its bottom border is aligned 
                with the bottom border of the base element.
              </p>
            </div>
          </div>
          <div class="block">
            <div class="block-header" id="block-header-3">
              <h2>Sticker Has Negative Top Margin</h2>
            </div>
            <div class="block-meta" id="block-meta-3" style="margin-top: -20px">
              #sticker3
            </div>
            <div class="block-body" id="block-body-3">
<pre><code>#sticker3 {
  margin-top: -20px;
}</code></pre>
              <p>
                The sticker is (partially) cropped by the viewport when stuck.
              </p>
            </div>
          </div>
          <div class="block">
            <div class="block-header" id="block-header-4">
              <h1>Padded Wrappers To The Rescue</h1>
              <p>
                What if the above stick-slip rule does not suit you?
                I could have enriched the plugin API with parameters,
                but decided to rely on the CSS properties of the sticker 
                element instead:
              </p>
            </div>
            <div class="block-meta-wrapper" id="block-meta-4" style="padding-top: 60px; margin-top: -20px">
              <div class="block-meta" style="float: none; margin-left: 0;">
                #sticker4
              </div>
            </div>
            <div class="block-body" id="block-body-4">
<pre><code>#wrapper4 {
  padding-top: 60px;
  margin-top: -20px;
}</code></pre>
              <p>
                When you need the sticker to start slipping before reaching the top
                of the viewport, wrap it into a <code>&lt;div&gt;</code> with 
                negative top margin and positive top padding exceeding that margin,
                and stick <i>that wrapper div</i> to the base.
              </p>
            </div>
          </div>
          <div class="block">
            <div class="block-meta-wrapper" id="block-meta-5" style="padding-bottom: 60px; margin-top: 20px">
              <div class="block-meta" style="float: none; margin-left: 0;">
                #sticker5
              </div>
            </div>
            <div class="block-body" id="block-body-5">
<pre><code>#wrapper5 {
  padding-bottom: 60px;
  margin-top: 20px;
}</code></pre>
              <p>
                Conversely, when you need the sticker to stop slipping before reaching 
                the bottom edge of the base, wrap it into a 
                <code>&lt;div&gt;</code> with positive bottom padding.
              </p>
            </div>
          </div>
          <div class="block">
            <div class="block-header" id="block-header-6">
              <h1>You Are Responsible For Clearing The Space</h1>
            </div>
            <div class="block-meta" id="block-meta-6" style="z-index: 1">#sticker6
            </div>
            <div class="block-meta" id="block-meta-66" style="margin-top: 120px;">Normally, I'd remain on top
            </div>
            <div class="block-body" id="block-body-6">
<pre><code>#sticker6 {
  z-index: 1;
}</code></pre>
              <p>
                If there are any other elements in the slip area, 
                they will obscure or be obsured by the sticker. Make sure to clear
                that area or use z-index appropriately.
              </p>
            </div>
          </div>
          <div class="block">
            <div class="block-header">
              <h1>This Is A Filler</h1>
            </div>
            <div class="block-meta">I won't slip!
            </div>
            <div class="block-body" id="filler">
              <p>
                This is a dummy block inserted to ensure that the stick-slip
                effect can be observed on the previous block
              </p>
            </div>
          </div>
        </div>
        <div id="sidebar">
          <div id="toc-wrapper">
            <div id="toc" class="toc">
            </div>
          </div>
        </div>
      </div>
      <div id="footer">
        <div id="copyright">
          Copyright &copy; 2011-2012 Dmitry Leskov.
        </div>
      </div>
    </div>
    <script type="text/javascript" src="jquery-1.6.1.min.js"></script>
    <script type="text/javascript" src="jquery.stickers.min.js"></script>
    <script type="text/javascript">
      <!--
        $(document).ready(function() {

          window.onerror = 
            function(errorMessage, fileName, lineNumber) {
              console.log(errorMessage+" "+fileName+" "+lineNumber)
              $("body")
                .css("border","10px solid red")
                .append(
                     $("<div>"+errorMessage+" "+fileName+" "+lineNumber+"</div>")
                       .css({
                         'display': 'block',
                         'position': 'fixed',
                         'top' : 0,
                         'left': 0
                       })      
                )
            }

          var loremIpsum = "<p class='loremipsum'>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>"
          var animationSpeed = 200
          var viewportHeight = $(window).height()
          var pageHeight = viewportHeight-204

          $(".block-body").filter("[id]")
            .append(loremIpsum)

          $("h1").each(function() {
            $("#toc").append("<p><a href='#"+$(this).parent().attr('id')+"'>"+$(this).text()+"</a></p>")
          })

          var start = $("#block-body-6").offset().top-$("#sidebar").offset().top
          var stop  = start+$("#block-body-6").outerHeight()-20
          for (t = start; t < stop; t+=80) {
            $("<div class='obscured obstacle'>Obscured</div>")
              .insertBefore("#toc-wrapper")
              .css({
                top: t,
                left: 5,
                backgroundColor: '#800',
                'box-shadow' : "3px 3px 5px rgba(136,68,68,0.5)"
              })
              .show()
            $("<div class='obstacle'>Obscures</div>")
              .insertAfter("#toc-wrapper")
              .css({
                top: t+40, 
                right: 5, 
                'box-shadow' : "10px 10px 5px rgba(136,68,68,0.5)"
              })
              .show()
          }
          $(window).bind('scroll hashchange', $(".obstacle"), function(event) {
            event.data.each(function() {
              var factor = ($(this).offset().top - $(window).scrollTop() - $(window).height()*0.25) / ($(window).height()*0.5);
              if (factor < 0) factor = 0
              else if (factor > 1) factor = 1
              if ($(this).hasClass('obscured'))
                $(this).css('left', 5-$(this).outerWidth()*factor)
              else
                $(this).css('right', 5-$(this).outerWidth()*factor)
            });
          });
          $("#filler").show()
          while ($("#filler").height() < viewportHeight) {
            $("#filler").append("<p class='loremipsum'>"+loremIpsum+"</p>")
          }
          
          // This is a workaround - when the TOC becomes absolutely positioned,
          // it disappears because the sidebar has overflow: hidden.
          $("#toc-wrapper").height($("#toc-wrapper").height())

          // The above workaround is in fact not necessary, as we have 
          // to enlarge the sidebar anyway as to make the "obstacle" bars visible.
          $("#sidebar").height($("#content").height())

          $("#sticker1").stick($("#base1"))
          $("#sticker2").stick($("#base2"))
          $("#block-meta-0").stick($("#block-body-0")) 
          $("#block-meta-1").stick($("#block-body-1")) 
          $("#block-meta-2").stick($("#block-body-2")) 
          $("#block-meta-3").stick($("#block-body-3")) 
          $("#block-meta-4").stick($("#block-body-4")) 
          $("#block-meta-5").stick($("#block-body-5")) 
          $("#block-meta-6").stick($("#block-body-6")) 
          $("#toc").stick($("#content"))

        })
      //-->
    </script>
  </body>
</html>